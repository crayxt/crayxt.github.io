---
layout: post
title: Что делать после установки Казсида
categories:
- news
tags:
- kazsid
status: publish
type: post
published: true
meta:
  _edit_last: '2'
author:
  login: cray
  email: baurthefirst@gmail.com
  display_name: cray
  first_name: ''
  last_name: ''
---
<p style="text-align: justify;">Рассмотрим на моем примере, что нужно и можно сделать сразу после установки Казсида. Как вы могли читать у меня в блоге ранее, Казсид заточен под среднего пользователя в лице меня. Но все свои настройки в него включить я не могу, и поэтому, даже мне приходится каждый раз донастраивать Казсид. Конечно, это мои личные заморочки, но, может быть, они будут полезны и вам.</p>
<p style="text-align: justify;">Мой тестовый полигон для Казсида - это мой ноутбук. Поэтому и большинство описанного далее больше подходит ноутбукам, нежели обычным компьютерам, это касается настроек сна и проч. Итак, приступим!</p>
<p style="text-align: justify;"><!--more--></p>
<p style="text-align: justify;">Жесткий диск ноутбука, объемом 120 ГБ, поделен на несколько разделов, также есть небольшое неразмеченное пространство. Я не держу домашний раздел постоянным, то есть сохраняющемся при переустановке системы. Мне это не нужно, так как Казсид желательно тестировать в том виде, каким он приходит, а не со старыми настройками. Это помогает замечать недоработки и вовремя устранять их.</p>
<p style="text-align: justify;">В начале диска у меня есть раздел подкачки размером 2 ГБ. Оперативной памяти на ноутбуке тоже 2 ГБ, к слову. Я не помню такого, чтобы на этом ноутбуке вся оперативная память забивалась и система переходила бы на использование подкачки. Этот раздел мне нужен, чтобы проводить hibernate в него, то бишь засыпать. Этого объема хватает. Впрочем, если у вас память забивается, увеличьте немного раздел подкачки. А лучше уж просто выключайте машину. Пробуждение из спячки гораздо быстрее, чем грузиться с нуля, да еще и файлы с прошлого раза остаются открытыми. Очень удобно.</p>
<p style="text-align: justify;">Далее, идет раздел, тоже 2 ГБ, под /boot. Он остался еще с тех времен, когда на ноутбуке был установлен Arch Linux. Сейчас этот раздел не используется.</p>
<p style="text-align: justify;">Далее, начинается расширенный раздел, и на нем первым разделом идет место для Казсида - 15 ГБ. Сюда влезает вся система, и даже кое-чего побольше можно установить, ну хотя бы в Wine. Под корневой раздел я всегда использую ext4.</p>
<p style="text-align: justify;">Далее, есть раздел в 40 ГБ, на котором хранится всё постоянная информация, что мне нужна. Всякие накачанные материалы, и книги в том числе. Ну и фотки, и дистрибутивы, и пара ISO файлов Казсида постарее. Во всяком случае, держу последний релиз, если вдруг понадобится систему восстанавливать. Кто ж его знает, как оно обернется. Монтируется данное щастье в новую систему стандартно, в /media/share. Это у меня привычка такая.</p>
<p style="text-align: justify;">Ну и дальше, прочие разделы, которые не суть важны, типа раздела под OpenBSD, старого домашнего раздела и т.д. и т.п.</p>
<p style="text-align: justify;">В общем, на этом самом 40 ГБ разделе есть папка, в которой хранится типовая конфигурация для ноутбука, такая как файл /etc/fstab. Я из него просто копирую строки в /etc/fstab новой системы.</p>
<p style="text-align: justify;">Также оттуда копируется файл do_pm-hibernate.sh в /etc/acpi/actions. Это скрипт, следующего содержания</p>
<blockquote><p><code>#!/bin/bash<br />
if [ `grep -c open /proc/acpi/button/lid/C20C/state` -eq "0" ]; then<br />
pm-hibernate;<br />
fi</code></p></blockquote>
<p style="text-align: justify;">Как видим, здесь реализован способ "ухождения в спячку" независимый от того, зашли ли вы в систему или нет, или от вашей рабочей среды. Затем откройте файл /etc/acpi/actions/lm_lid.sh, закомментируйте там последнюю строку и вместо нее поставьте наш скрипт. Вот так выглядит этот файл у меня</p>
<blockquote><p><code>#! /bin/sh<br />
test -f /usr/sbin/laptop_mode || exit 0<br />
# lid button pressed/released event handler<br />
#/usr/sbin/laptop_mode auto<br />
/etc/acpi/actions/do_pm-hibernare.sh</code></p></blockquote>
<p style="text-align: justify;">А путь <code>/proc/acpi/button/lid/C20C/state</code> зависит от вашей модели ноутбука, и конечно же, неприемлем для обычного компьютера. Определяйте его опытным путем! Пояснение: Скрипт срабатывает тогда, когда закрывается или открывается крышка ноутбука. В первом случае скрипт определяет, что крышка именно <em>закрылась</em>, и отправляет систему в спячку.</p>
<p style="text-align: justify;">Так, компьютер теперь может засыпать, если у вас раздел подкачки настроен и подключен. Это половина дела, теперь же сделаем так, чтобы он и <em>просыпался</em>. Для этого откроем файл /etc/default/grub, находим строчку с переменной GRUB_CMDLINE_LINUX_DEFAULT, и дописываем в него значение resume=/dev/sda1, где  /dev/sda1 - это раздел подкачки. Затем запускаем команду sudo update-grub2, и готово! Теперь мы умеем и просыпаться. Однако, советую иногда рестартовать машину и обычным способом, ибо ошибки имеют свойство накапливаться. А также, обязательно проверяйте дисковые разделы на наличие ошибок, то есть, выставляйте последний параметр для дискового раздела в /etc/fstab в единицу. Смекаете? Лучше уж лишний раз подождать окончания проверки, чем использовать раздел с ошибками, а тем более писать в него.</p>
<p style="text-align: justify;">Ну вот и все. Скоро сказка сказывается, но дело делается еще быстрее, на автомате. Этому способствует и то, что переустанавливаю Казсид ну очень часто. Кто-то же должен его тестировать и полигонить.</p>
<p style="text-align: justify;">За сим откланиваюсь. Ждите новостей.</p>
