---
layout: post
title: Установка OpenBSD с USB flash disk
categories:
- useful
tags:
- openbsd
status: publish
type: post
published: true
meta:
  _edit_last: '2'
  dsq_thread_id: '2595313182'
author:
  login: cray
  email: baurthefirst@gmail.com
  display_name: cray
  first_name: ''
  last_name: ''
---
<p style="text-align: justify;">Если вы все-таки решили установить OpenBSD, то будьте осторожны, не потеряйте данные. Впрочем, это касается и любого дистрибутива Линукса, особенно, если вы - новичок. Вначале, подумайте хорошенько, нужно ли это вам. Если решились, то прошу всю ответственность брать на себя. А еще совет по установке - всегда лучше потренироваться перед реальной установкой. Отлично подойдет виртуалка, или компьютер с жестким диском, данные с которого не страшно потерять. Хотя разве такое бывает?</p>
<p style="text-align: justify;">Повторяю еще раз - для начала почитайте официальное <a href="http://www.openbsd.org/faq/faq4.html" target="_blank">руководство по установке OpenBSD</a>!</p>
<p>Дальше в общих чертах расскажу, как я устанавливаю OpenBSD на диск с уже имеющейся ОС Линукс.</p>
<p style="text-align: justify;">Я сам не до конца разобрался с философией разбивки жесткого диска в этой ОС, то есть с порядком работы ее менеджера дисковых разделов disklabel. Поэтому, я создал раздел на жестком диске под эту систему, сидя в уютном Казсиде, с помощью утилитки cfdisk. Делал так, создаю раздел, затем меняю его тип на <strong>A6</strong>, это - идентификатор дискового раздела с файловой системой OpenBSD. Эта ОС использует технологию "слайсов", то есть берется обычный дисковый раздел с типом <strong>A6</strong>, и для всех остальных ОС он виден как один раздел. А уж дальше, как делают BSD системы, этот раздел разбивается еще на меньшие части, т.н. "слайсы". И уже эти самые слайсы и монтируются в OpenBSD. Надеюсь, понятно. Если нет - опять же, читайте официальное руководство.</p>
<p style="text-align: justify;">Если вы помните, я стараюсь все установки производить с флешки с установленным загрузчиком GRUB2.</p>
<p style="text-align: justify;">Открываю архиватором ISO-образ <strong>install51.iso</strong>, и из него вытаскиваю директорию с версией системы, что лежит сразу в корне. То есть, для текущего релиза это папка 5.1. Копирую ее на флешку, на которой установлен GRUB2, а рядом лежат <strong>memdisk</strong>.</p>
<p style="text-align: justify;">Грузимся с флешки, выбираем ввод команд GRUB2 руками, то есть нажимаем <strong>c</strong> в меню загрузки. Затем вводим</p>
<blockquote><p><code><br />
linux16 /memdisk iso<br />
initrd16 /install51.iso<br />
boot<br />
</code></p></blockquote>
<p style="text-align: justify;">Загрузка пошла! У OpenBSD установщик идет в ядре, если грузиться с образа ISO. Отвечаем на вопросы, задаем все параметры, типа пароля рута и создаем пользователя. Затем система спросит куда ей устанавливаться. Укажем ей на свой жесткий диск (sd0). И вот тут, внимание, установщик должен увидеть подготовленный нами ранее раздел жесткого диска. Если увидел, то выбираем вариант установки OpenBSD area, и дальше как написано в руководстве, установщик отформатирует разделы.</p>
<p style="text-align: justify;">Для надежности, я записал, с какого сектора начинается раздел OpenBSD и сколько секторов он занимает. И сравнил с тем, что увидел установщик. У меня все совпало, так что я был уверен, что система установится именно в подготовленный для нее раздел.</p>
<p style="text-align: justify;">Затем укажем источник установки, метод disk, выбираем свою флешку. Если она у вас в компьютер воткнута одна в данный момент, и жестких дисков у компьютера всего один, то выбирайте диск sd1. Установщик примонтирует носитель, найдет там папку 5.1 и начнет ставить систему. Установка завершена!</p>
<p style="text-align: justify;">А загрузчик использую Линуксовый, GRUB2 от Казсида.</p>
<p style="text-align: justify;">Пишу в нем руками,</p>
<blockquote><p><code>set root=(hd0,msdos6)<br />
chainloader +1<br />
boot</code></p></blockquote>
<p style="text-align: justify;">Ну или прописать две верхние строчки в /boot/grub/grub.cfg. msdos6, как вы понимаете, это раздел с OpenBSD, в Linux-e виден как /dev/sda6.</p>
